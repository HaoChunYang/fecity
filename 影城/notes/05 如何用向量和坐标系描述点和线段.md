# 05 如何用向量和坐标系描述点和线段?

> 如果我们手中只有解决具体问题的工具，没有统一的方法论，那我们也无法一劳永逸地解决问题的根本。

建立一套与各外图形系统无关联的，简单的基于向量和矩阵运算的数学体系，用它来描述所有的几何图形。

- 目标：
  > **如何建立一套描述几何图形信息的数学体系，以及如何用这个体系解决可视化图形的问题**

本节目标：

- 用坐标系和向量来描述基本图形的方法

1. 如何定义和变换图形的直角坐标系
2. 如何运用向量表示点和线段

## 坐标与坐标映射

- Html: 窗口坐标系；x 轴向右，y 轴向下。
- SVG: 视区盒子(viewBox)坐标系.x 轴向右，y 轴向下。右下角坐标为像素宽高值。左上角为 viewBox 的前两个值。
- canvas: 左上角为坐标原点，右下角坐标值为画布宽度。x 轴向右，y 轴向下。左手系
- WebGL: 三维坐标系。画布中心为原点(0, 0)，x 轴向右，y 轴向上，z 轴向外。x,y 的范围是 -1 到 1

都是直角坐标系。

转换坐标系，`transform`
webgl 通过在 shader 中做矩阵运算，实现坐标转换。

[Canvas 通过转换坐标画图小示例](./../practice/05.html)

## 如何描述点和线段

无论什么图形系统，一般的几何图形都是由点、线段和面构成，其中点和线段是基础图元信息。如何描述它们是关键。

- 在直角坐标系中，我们一般用向量描述点和线段

- 相关数学知识

1. 向量的加减法
2. 一个向量包含有长度和方向的信息。长度可以用向量的 x y 的平方和的平方根来表示。它的方向可以用与 x 轴的夹角来表示。

```js
// 获取长度
v.length = function () {
  return Math.hypot(this.x, this.y);
};
// 方向，计算与 x 轴的夹角
v.dir = function () {
  return Math.atan2(this.y, this.x);
};
// Math.atan2 的取值范围是 -π 到 π , 负数表示在 x 轴的下方，正数表示在 x 轴的上方。
```

根据长度和方向的定义，推导出一组关系式：

```js
v.x = v.length * Math.cos(v.dir);
v.y = v.length * Math.sin(v.dir);
```

## [练习：用向量绘制一棵树](./../practice/05.html)

### 链接

[手绘风格库 Rough.js](https://github.com/rough-stuff/rough)
